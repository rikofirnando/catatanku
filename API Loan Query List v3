#!/bin/bash

authorization_list=(
    # 135 MSISDN LIST from CREDIT_SCORING 
    "628118118715"
    "628120920001"
    "6281210049732"
    "6281211252959"
    "6281212258645"
    "6281212259807"
    "6281213015659"
    "6281213356236"
    "6281213396342"
    "6281213396361"
    "6281213396368"
    "6281213396370"
    "6281213396371"
    "6281213396372"
    "6281213587277"
    "6281214268946"
    "6281218144200"
    "6281218144200"
    "6281219201563"
    "6281242921437"
    "6281253402897"
    "6281265924994"
    "6281280485530"
    "6281282290779"
    "6281282325226"
    "6281282703173"
    "6281287037943"
    "6281288062534"
    "6281290945857"
    "6281292302515"
    "6281292302517"
    "6281292302563"
    "6281293414852"
    "6281293414856"
    "6281294633690"
    "6281294906198"
    "6281298235181"
    "6281312265920"
    "6281312265920"
    "6281314844012"
    "6281316883269"
    "6281326446645"
    "6281357071760"
    "6281361364748"
    "6281362308029"
    "6281366038500"
    "6281375209416"
    "6281375209433"
    "6281381354866"
    "6281381354903"
    "6281381364819"
    "6281381364823"
    "6281381364897"
    "6281381364902"
    "6281381364965"
    "6281381364975"
    "6281381367481"
    "6281381367505"
    "6281381367514"
    "6281381367524"
    "6281381367525"
    "6281381367526"
    "6281381367527"
    "6281381582806"
    "6281382623291"
    "6281382859398"
    "6281385961587"
    "6281387479544"
    "6282110500766"
    "6282110776555"
    "6282110818281"
    "6282111512804"
    "6282111512883"
    "6282111966305"
    "6282111966312"
    "6282111966318"
    "6282111966319"
    "6282111966320"
    "6282111966324"
    "6282111966326"
    "6282111966328"
    "6282111966331"
    "6282112904783"
    "6282114268231"
    "6282114268231"
    "6282114313127"
    "6282114561361"
    "6282114611517"
    "6282116214404"
    "6282121202786"
    "6282122131267"
    "6282124746927"
    "6282124913385"
    "6282124913385"
    "6282124913385"
    "6282125070445"
    "6282125216739"
    "6282125216739"
    "6282125216739"
    "6282133662855"
    "6282137292982"
    "6282142273196"
    "6282142273198"
    "6282142273198"
    "6282142315710"
    "6282142315713"
    "6282142315716"
    "6282177707675"
    "6282190168756"
    "6282193127095"
    "6282193127096"
    "6282193127098"
    "6282193127101"
    "6282193127102"
    "6282193127103"
    "6282197937541"
    "6282199942582"
    "6282210068315"
    "6282210526974"
    "6282211533205"
    "6282243060906"
    "6282255878657"
    "6282260886795"
    "6282282171770"
    "6282292651535"
    "6282292651535"
    "6282299928288"
    "6282334979259"
    "6285218815356"
    "6285255513800"
    "6285282240426"
    "6285282240428"
    "6285320901118"
    "6285320901118"
    "6287775973455"
)


generate_random_number() {
    min=$1
    max=$2
    echo $(( min + RANDOM % (max - min + 1) ))
}

# Loop from Authorization_list
for msisdn in "${authorization_list[@]}"
do
    # Generate Number from range 0-999999999
    random_number=$(generate_random_number 0 999999999)

    # Create Authorization using SHA256SUM, Base64, and SED
    authorization=$(printf '%s' "${msisdn}TESTING${random_number}" | sha256sum | cut -f1 -d' ' | base64 -w 0 | sed 's/o=/==/g')

    # Perform a curl request with authorization results
    curl -kvvv --header "Content-Type: application/json" --header "Authorization: $authorization" "https://10.54.58.87:14001/loena/v3/queryProfile?msisdn=$msisdn&transaction_id=TESTING$random_number&filter_history=true&payment_reminder_history=true&push_offer_history=true"
done
